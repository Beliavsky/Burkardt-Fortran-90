<html>

  <head>
    <title>
      circle_packing
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      circle_packing <br> Circle Packing Measure.
    </h1>

    <hr>

    <p>
      <b>circle_packing</b>,
      a FORTRAN90 code which
      analyzes point sets in the unit square (or M-dimensional unit hypercube).
    </p>

    <p>
      The point sets are to be measured in terms of a circle-packing
      test.  The point of the test can best be described in analogy.
      Suppose that, at each point in the set, we place a (two dimensional)
      balloon of initial radius 0.  At a given instant, all the balloons
      begin to expand.  If any two balloons touch, they instantly stop
      expanding.  Once all the balloons have stopped expanding, we
      record the radius of each balloon.
    </p>

    <p>
      The point sets we are interested in have been generated by a
      variety of algorithms, and are stored as datasets, of
      spatial dimension 2, 7 and 16, and sample sizes 10, 100,
      1,000 and 10,000.  The point set types include:
      <ul>
        <li>
          Centroidal Voronoi Tessellation values;
        </li>
        <li>
          Faure quasirandom values;
        </li>
        <li>
          Halton quasirandom values;
        </li>
        <li>
          Hammersley quasirandom values;
        </li>
        <li>
          Improved Distributed Hypercube Sampling (IHS) values;
        </li>
        <li>
          Latin Center Square values;
        </li>
        <li>
          Latin Edge Square values;
        </li>
        <li>
          Latin Random Square values;
        </li>
        <li>
          Niederreiter quasirandom values (base 2);
        </li>
        <li>
          Sobol quasirandom values;
        </li>
        <li>
          uniform random values;
        </li>
      </ul>
    </p>

    <p>
      The amount of area covered by the circles is compared to the
      area of the unit square.  This measurement has a certain amount
      of boundary effect, and is more effective when the number of
      points is large, so that the boundary effects can be ignored.
      In order to make a meaningful number to report, we prefer, then,
      to restrict the balloons so that they cannot extend outside
      the unit square.  In this way we can compare the coverage for
      a given set of points to that produced by a maximal sphere packing
      set, for which the balloons are all of the same size.
    </p>

    <p>
      Note that, for each datapoint, the radius of the associated circle
      is the minimum distance to the nearest boundary of the Voronoi
      cell containing the point.
    </p>

    <p>
      Based on this measure of coverage, a "good" dataset would be one
      for which the value was maximal.  We might also be interested in
      the variation in the sizes of the radiuses.
    </p>

    <p>
      In the limit, the maximum relative packing density of a 2D
      region with equal sized spheres is 0.9069.  In 3D, a density
      of at least 0.74 can be achieved, and it is known that no
      greater than 0.7796 is possible.
    </p>

    <p>
      <b>(in)Efficiency Note</b>: As currently programmed, the routine
      is inefficient, taking execution time that is O(N^3).  This is
      because there are about N steps of the iteration, each of which
      "retires" one point by finding its maximal radius; in each of the
      N steps, the program recomputes the distances between every
      unretired point and all the N points.  A more clever program
      would construct the Voronoi diagram, and then each point would
      only have to worry about its nearest neighbors.
    </p>

    <p>
      For instance, for the 2D Halton datasets, here is the table
      of the number of points versus unrestricted (spheres can extend
      out of the unit hypercube) and restricted (they can't)
      scores:
      <table "border=1">
        <tr><th>Points</th><th>Unrestricted</th><th>Restricted</th></tr>
        <tr><td>   10</td><td>0.8203</td><td>0.3884</td></tr>
        <tr><td>  100</td><td>0.5416</td><td>0.4067</td></tr>
        <tr><td> 1000</td><td>0.4299</td><td>0.3959</td></tr>
        <tr><td>10000</td><td>0.4214</td><td>(unavailable)</td></tr>
      </table>
      It is a comfort to see that the restricted scores are more
      tightly clustered than the unrestricted ones.  This is a reflection
      of the fact that they measure a geometrically meaningful
      quantity that can be compared directly to 1, the volume of
      the unit hypercube, and to the maximal packing density.
    </p>

    <p>
      A collection of sample datasets, and plots of the points and the
      circles involved in the circle test, is available at
      <a href = "../../datasets/sample_2d/sample_2d.html">sample_2d</a>.
    </p>

    <h3 align = "center">
      Usage:
    </h3>

    <p>
      <blockquote>
        <b>circle_packing</b> <i>input_file</i>
      </blockquote>
      where
      <ul>
        <li>
          <i>input_file</i> is the input file.
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files made available on this web page
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>circle_packing</b> is available in
      <a href = "../../f_src/circle_packing/circle_packing.html">a FORTRAN90 version.</a>
    </p>

    <h3 align = "center">
      Related Programs:
    </h3>

    <p>
      <a href = "../../f_src/circle_packing_test/circle_packing_test.html">
      circle_packing_test</a>
    </p>

    <p>
      <a href = "../../c_src/diaphony/diaphony.html">
      DIAPHONY</a>,
      a C program which
      reads a file of N points in M dimensions and computes its diaphony, a measure
      of point dispersion.
    </p>

    <p>
      <a href = "../../c_src/star_discrepancy/star_discrepancy.html">
      STAR_DISCREPANCY</a>,
      a C program which
      reads a file of N points in M dimensions, (presumed to lie in the
      unit hypercube) and computes bounds on the star discrepancy,
      a measure of dispersion, by Eric Thiemard.
    </p>

    <p>
      <a href = "../../f_src/table_quality/table_quality.html">
      TABLE_QUALITY</a>,
      a FORTRAN90 program which
      computes the quality measures of a dataset read from a file.
      which can analyze a dataset that is stored in a file.
    </p>

    <p>
      <a href = "../../f_src/tet_mesh_quality/tet_mesh_quality.html">
      TET_MESH_QUALITY</a>,
      a FORTRAN90 program which
      computes quality measures of a tetrahedral mesh.
    </p>

    <p>
      <a href = "../../f_src/triangulation_quality/triangulation_quality.html">
      TRIANGULATION_QUALITY</a>,
      a FORTRAN90 program which
      computes quality measures of a triangulation.
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "circle_packing.f90">circle_packing.f90</a>, the source code.
        </li>
        <li>
          <a href = "circle_packing.sh">circle_packing.sh</a>, 
          compiles the source code.
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 09 June 2020.
    </i>

    <!-- John Burkardt -->

  </body>

</html>
