<html>

  <head>
    <title>
      KMEANS - the K-Means Data Clustering Problem
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      KMEANS <br> the K-Means Data Clustering Problem
    </h1>

    <hr>

    <p>
      <b>KMEANS</b>,
      a FORTRAN90 code which
      handles the K-Means problem,
      which organizes a set of N points in M dimensions into K clusters;
    </p>

    <p>
      In the K-Means problem, a set of N points X(I) in M-dimensions is
      given.  The goal is to arrange these points into K clusters,
      with each cluster having a representative point Z(J), usually
      chosen as the centroid of the points in the cluster.  <pre>
        Z(J) = Sum ( all X(I) in cluster J ) X(I) /
               Sum ( all X(I) in cluster J ) 1.
      </pre>
      The energy of cluster J is <pre>
        E(J) = Sum ( all X(I) in cluster J ) || X(I) - Z(J) ||^2
      </pre>
    </p>

    <p>
      For a given set of clusters, the total energy is then simply
      the sum of the cluster energies E(J).  The goal is to choose the
      clusters in such a way that the total energy is minimized.
      Usually, a point X(I) goes into the cluster with the closest
      representative point Z(J).  So to define the clusters, it's
      enough simply to specify the locations of the cluster representatives.
    </p>

    <p>
      This is actually a fairly hard problem.  Most algorithms do
      reasonably well, but cannot guarantee that the best solution
      has been found.  It is very common for algorithms to get
      stuck at a solution which is merely a "local minimum".
      For such a local minimum, every slight rearrangement of
      the solution makes the energy go up; however a major
      rearrangement would result in a big drop in energy.
    </p>

    <p>
      A simple algorithm for the problem is known as the "H-Means algorithm".
      It alternates between two procedures:
      <ul>
        <li>
          Using the given cluster centers, assign each point to the
          cluster with the nearest center;
        </li>
        <li>
          Using the given cluster assignments, replace each cluster
          center by the centroid or average of the points in the cluster.
        </li>
      </ul>
      These steps are repeated until no points are moved, or some
      other termination criterion is reached.
    </p>

    <p>
      A more sophisticated algorithm, known as the "K-Means algorithm",
      takes advantage of the fact that it is possible to quickly determine
      the decrease in energy caused by moving a point from its current cluster
      to another.  It repeats the following procedure:
      <ul>
        <li>
          For each point, move it to another cluster if that would lower
          the energy.  If you move a point, immediately update the
          cluster centers of the two affected clusters.
        </li>
      </ul>
      This procedure is repeated until no points are moved, or some
      other termination criterion is reached.
    </p>

    <h3 align = "center">
      The Weighted K-Means Problem
    </h3>

    <p>
      A natural extension of the K-Means problem allows us to include
      some more information, namely, a set of <i>weights</i> associated
      with the data points.  These might represent a measure of importance,
      a frequency count, or some other information.  The intent is that
      a point with a weight of 5.0 is twice as "important" as a point with
      a weight of 2.5, for instance.  This gives rise to the "weighted"
      K-Means problem.
    </p>

    <p>
      In the <i>weighted K-Means problem</i>, we are given a set of N points
      X(I) in M-dimensions, and a corresponding set of nonnegative weights
      W(I).  The goal is to arrange the points into K clusters,
      with each cluster having a representative point Z(J), usually
      chosen as the weighted centroid of the points in the cluster: <pre>
        Z(J) = Sum ( all X(I) in cluster J ) W(I) * X(I) /
               Sum ( all X(I) in cluster J ) W(I).
      </pre>
      The weighted energy of cluster J is <pre>
        E(J) = Sum ( all X(I) in cluster J ) W(I) * || X(I) - Z(J) ||^2
      </pre>
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>KMEANS</b> is available in
      <a href = "../../c_src/kmeans/kmeans.html">a C version</a> and
      <a href = "../../cpp_src/kmeans/kmeans.html">a C++ version</a> and
      <a href = "../../f_src/kmeans/kmeans.html">a FORTRAN90 version</a> and
      <a href = "../../m_src/kmeans/kmeans.html">a MATLAB version.</a>
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../f_src/asa058/asa058.html">
      ASA058</a>,
      a FORTRAN90 code which
      implements the K-means algorithm of Sparks.
    </p>

    <p>
      <a href = "../../f_src/asa136/asa136.html">
      ASA136</a>,
      a FORTRAN90 code which
      implements the Hartigan and Wong clustering algorithm.
    </p>

    <p>
      <a href = "../../f_src/cities/cities.html">
      CITIES</a>,
      a FORTRAN90 code which
      handles various problems associated with a set of "cities" on a map.
    </p>

    <p>
      <a href = "../../datasets/cities/cities.html">
      CITIES</a>,
      a dataset directory which
      contains sets of data defining groups of cities.
    </p>

    <p>
      <a href = "../../f_src/cluster_energy/cluster_energy.html">
      CLUSTER_ENERGY</a>,
      a FORTRAN90 code which
      groups data into a given number of clusters to minimize the energy.
    </p>

    <p>
      <a href = "../../f_src/kmeans_test/kmeans_test.html">
      kmeans_test</a>
    </p>

    <p>
      <a href = "../../f_src/lau_np/lau_np.html">
      LAU_NP</a>,
      a FORTRAN90 code which
      contains heuristic algorithms for the K-center and K-median problems.
    </p>

    <p>
      <a href = "../../f_src/point_merge/point_merge.html">
      POINT_MERGE</a>,
      a FORTRAN90 code which
      considers N points in M dimensional space, and counts or indexes
      the unique or "tolerably unique" items.
    </p>

    <p>
      <a href = "../../f_src/spaeth/spaeth.html">
      SPAETH</a>,
      a FORTRAN90 code which
      can cluster data according to various principles.
    </p>

    <p>
      <a href = "../../datasets/spaeth/spaeth.html">
      SPAETH</a>,
      a dataset directory which
      contains a set of test data.
    </p>

    <p>
      <a href = "../../f_src/spaeth2/spaeth2.html">
      SPAETH2</a>,
      a FORTRAN90 code which
      can cluster data according to various principles.
    </p>

    <p>
      <a href = "../../datasets/spaeth2/spaeth2.html">
      SPAETH2</a>,
      a dataset directory which
      contains a set of test data.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          John Hartigan, Manchek Wong,<br>
          Algorithm AS 136:
          A K-Means Clustering Algorithm,<br>
          Applied Statistics,<br>
          Volume 28, Number 1, 1979, pages 100-108.
        </li>
        <li>
          Wendy Martinez, Angel Martinez,<br>
          Computational Statistics Handbook with MATLAB,<br>
          Chapman and Hall / CRC, 2002.
        </li>
        <li>
          David Sparks,<br>
          Algorithm AS 58:
          Euclidean Cluster Analysis,<br>
          Applied Statistics,<br>
          Volume 22, Number 1, 1973, pages 126-130.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "kmeans.f90">kmeans.f90</a>, the source code.
        </li>
        <li>
          <a href = "kmeans.sh">kmeans.sh</a>, compiles the source code.
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 22 July 2020.
    </i>

    <!-- John Burkardt -->

  </body>

</html>
